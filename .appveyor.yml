version: '{build}'

os: Visual Studio 2013

environment:
  DROP_AUTH_TEST:
    secure: PtPliCsi+UYMTcvO57ffYRnZsdqYk8te8GSj10S2dAI=
  DROP_AUTH_TOK:
    secure: N2IK1SYHi918dXsfMrQRuX9FqrtTapnCW0Vs7H/06AVKslsTNAG99q5RVZ8PVIZ/+6mJ18LzxUdWcf3CoTN7LjmnAI5hwLZTpVMZvCAv2Dk=
  matrix:
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "cuda"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "ffmpeg"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "fftw"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "gsl"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "leptonica,tesseract"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "libdc1394"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "libfreenect"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "libfreenect2"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "hdf5"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "liquidfun"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "llvm"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "videoinput"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "tensorflow"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "opencv,chilitags,flandmark,openblas,mxnet,caffe"
    - COMPILER: msys2
      PLATFORM: x64
      MSYS2_ARCH: x86_64
      MSYS2_DIR: msys64
      MSYSTEM: MINGW64
      BIT: 64
      PROJ: "artoolkitplus"


init:
#    - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
      
install:
    - 'echo install section'
    - 'cd ..'
    - 'git clone https://github.com/bytedeco/javacpp.git'
    - 'cd javacpp'
    - 'git checkout d7d6af2b4a2d5e5d3ea48cb27248e2f84a031fd2'
#    - 'mvn install'
    - 'cd ../javacpp-presets'

build_script:
    - 'echo build step for %PROJ%'
    - '%APPVEYOR_BUILD_FOLDER%\build.bat "%PROJ%" "%DROP_AUTH_TOK%"'


test_script:
    - 'echo no tests'

on_finish:
#    - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

