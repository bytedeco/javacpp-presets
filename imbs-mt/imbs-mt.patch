--- CMakeLists.txt	2016-12-29 06:34:50.000000000 -0800
+++ CMakeLists.txt.new	2019-09-25 13:20:33.242434700 -0700
@@ -2,9 +2,22 @@
 
 cmake_minimum_required(VERSION 2.8 FATAL_ERROR)
 
+message(STATUS "OpenCV_DIR = ${OpenCV_DIR}")
+message(STATUS "CMAKE_CURRENT_SOURCE_DIR = ${CMAKE_CURRENT_SOURCE_DIR}")
+message(STATUS "CMAKE_CURRENT_LIST_DIR = ${CMAKE_CURRENT_LIST_DIR}")
+
+if(EXISTS "${OpenCV_DIR}")
+	message(STATUS "Found OPENCV")
+else(EXISTS "${OpenCV_DIR}")
+	message(STATUS "Please specify OpenCV directory using OpenCV_DIR env. variable")
+endif(EXISTS "${OpenCV_DIR}")
+
 find_package(OpenCV REQUIRED)
 
-include_directories(${PROJECT_BINARY_DIR})
+include_directories(${PROJECT_BINARY_DIR} ${OpenCV_INCLUDE_DIRS})
+
+message(STATUS "OpenCV_INCLUDE_DIRS = ${OpenCV_INCLUDE_DIRS}")
+message(STATUS "OpenCV_LIBS = ${OpenCV_LIBS}")
 
 include(CheckCXXCompilerFlag)
 CHECK_CXX_COMPILER_FLAG("-std=c++11" COMPILER_SUPPORTS_CXX11)
@@ -19,10 +32,12 @@
 
 set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin)
 
-add_executable (${PROJECT_NAME} imbs.cpp imbsmultithread.cpp imagemanager.cpp main.cpp)
+add_library(${PROJECT_NAME} STATIC imbs.cpp imbsmultithread.cpp imagemanager.cpp)
+add_library(${PROJECT_NAME}-shared SHARED imbs.cpp imbsmultithread.cpp imagemanager.cpp)
 if (WIN32)
-target_link_libraries (${PROJECT_NAME} ${OpenCV_LIBS})
+target_link_libraries (${PROJECT_NAME} ${OpenCV_LIBS})
+target_link_libraries (${PROJECT_NAME}-shared ${OpenCV_LIBS})
 else ()
-target_link_libraries (${PROJECT_NAME} ${OpenCV_LIBS} -lm -lpthread)
+target_link_libraries (${PROJECT_NAME} ${OpenCV_LIBS} -lm -lpthread)
+target_link_libraries (${PROJECT_NAME}-shared ${OpenCV_LIBS} -lm -lpthread)
 endif()
-
