<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>org.bytedeco</groupId>
    <artifactId>javacpp-presets</artifactId>
    <version>1.4.2-SNAPSHOT</version>
  </parent>

  <groupId>org.bytedeco.javacpp-presets</groupId>
  <artifactId>tensorflow</artifactId>
  <version>${tensorflow.version}-${project.parent.version}</version>
  <name>JavaCPP Presets for TensorFlow</name>

  <properties>
    <tensorflow.version>1.8.0</tensorflow.version>
    <tensorflow.path>${basedir}/cppbuild/${javacpp.platform}${javacpp.platform.extension}/tensorflow-${tensorflow.version}/</tensorflow.path>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.bytedeco</groupId>
      <artifactId>javacpp</artifactId>
    </dependency>
    <dependency>
      <groupId>com.google.android</groupId>
      <artifactId>android</artifactId>
      <version>4.1.1.4</version>
      <exclusions>
        <exclusion>
            <groupId>*</groupId>
            <artifactId>*</artifactId>
        </exclusion>
      </exclusions>
      <optional>true</optional>
    </dependency>
    <dependency>
      <groupId>javax</groupId>
      <artifactId>javaee-api</artifactId>
      <version>7.0</version>
      <optional>true</optional>
    </dependency>
    <dependency>
      <groupId>org.checkerframework</groupId>
      <artifactId>checker</artifactId>
      <version>2.5.0</version>
      <optional>true</optional>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <artifactId>maven-resources-plugin</artifactId>
      </plugin>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <executions>
          <execution>
            <id>default-compile</id>
            <configuration>
              <includes>
                <include>org/tensorflow/**/*.java</include>
                <include>org/bytedeco/javacpp/*.java</include>
              </includes>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.bytedeco</groupId>
        <artifactId>javacpp</artifactId>
        <configuration>
          <includePaths>
            <includePath>${tensorflow.path}/</includePath>
            <includePath>${tensorflow.path}/bazel-genfiles/</includePath>
            <includePath>${tensorflow.path}/bazel-tensorflow-${tensorflow.version}/</includePath>
            <includePath>${tensorflow.path}/bazel-tensorflow-${tensorflow.version}/external/nsync/public/</includePath>
            <includePath>${tensorflow.path}/bazel-tensorflow-${tensorflow.version}/external/protobuf_archive/src/</includePath>
            <includePath>${tensorflow.path}/bazel-tensorflow-${tensorflow.version}/external/eigen_archive/</includePath>
            <includePath>${tensorflow.path}/bazel-tensorflow-${tensorflow.version}/external/eigen_archive/eigen-eigen-d02e6a705c30/</includePath>
            <includePath>${tensorflow.path}/../build/</includePath>
            <includePath>${tensorflow.path}/../build/zlib/src/zlib/</includePath>
            <includePath>${tensorflow.path}/../build/nsync/src/nsync/public/</includePath>
            <includePath>${tensorflow.path}/../build/protobuf/src/protobuf/src/</includePath>
            <includePath>${tensorflow.path}/../build/eigen/src/eigen/</includePath>
            <includePath>${basedir}/target/classes/org/bytedeco/javacpp/include/</includePath>
          </includePaths>
          <linkPaths>
             <linkPath>${tensorflow.path}/bazel-bin/tensorflow/</linkPath>
             <linkPath>${tensorflow.path}/../build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/zlib/src/zlib/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/grpc/src/grpc/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/farmhash/src/farmhash/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/fft2d/src/fft2d/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/lmdb/src/lmdb-build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/gif/src/gif-build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/jpeg/src/jpeg-build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/png/src/png-build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/nsync/src/nsync/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/protobuf/src/protobuf/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/re2/src/re2/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/snappy/src/snappy/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/sqlite/src/sqlite-build/Release/</linkPath>
             <linkPath>${tensorflow.path}/../build/tf_cc_op_gen_main.dir/Release/</linkPath>
          </linkPaths>
          <targetDirectory>${basedir}/cppbuild/${javacpp.platform}${javacpp.platform.extension}/java/</targetDirectory>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-jar-plugin</artifactId>
        <executions>
          <execution>
            <id>default-jar</id>
            <configuration>
              <includes>
                <include>org/tensorflow/**</include>
                <include>org/bytedeco/javacpp/*</include>
                <include>org/bytedeco/javacpp/helper/*</include>
                <include>org/bytedeco/javacpp/presets/*</include>
              </includes>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <artifactId>maven-dependency-plugin</artifactId>
      </plugin>
      <plugin>
        <artifactId>maven-source-plugin</artifactId>
      </plugin>
      <plugin>
        <artifactId>maven-javadoc-plugin</artifactId>
      </plugin>
    </plugins>
  </build>

  <profiles>
    <profile>
      <id>msvc</id>
      <activation>
        <os><family>windows</family></os>
      </activation>
      <build>
        <plugins>
          <plugin>
            <groupId>org.bytedeco</groupId>
            <artifactId>javacpp</artifactId>
            <configuration>
              <properties>${javacpp.platform}</properties>
              <compilerOptions>
                <compilerOption>/DCOMPILER_MSVC</compilerOption>
                <compilerOption>/DTF_COMPILE_LIBRARY</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/exception_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/graph_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/operation_builder_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/operation_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/saved_model_bundle_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/session_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/tensorflow_jni.cc</compilerOption>
                <compilerOption>${tensorflow.path}/tensorflow/java/src/main/native/tensor_jni.cc</compilerOption>
                <compilerOption>/link</compilerOption>
                <compilerOption>/WHOLEARCHIVE:tensorflow_static.lib</compilerOption>
              </compilerOptions>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>

</project>
